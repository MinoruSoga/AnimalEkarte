# 動物病院管理システム 仕様定義書

## 1. プロジェクト概要
本プロジェクトは、ReactとTailwind CSSを用いたモダンなWebベースの動物病院向け統合管理システム（PMS: Practice Management System）のプロトタイプです。
予約管理、受付、電子カルテ、入院管理、会計までの一連の業務フローをシームレスに連携させ、獣医療現場の業務効率化と質の高い医療提供を支援することを目的としています。

## 2. 技術スタック

### フロントエンド
- **Core**: React, TypeScript
- **Build Tool**: Vite (想定)
- **Routing**: React Router
- **State Management**: React Hooks (Custom Hooks), Context API

### UI/UX & デザインシステム
- **CSS Framework**: Tailwind CSS v4
- **Component Library**: shadcn/ui (Radix UI Primitives ベース)
    - プロジェクト内にソースコードとして配置 (`/components/ui`)
- **Design System**: Notion Like Design System (詳細は `/DESIGN_SYSTEM.md` を参照)
- **Icons**: Lucide React
- **Charts**: Recharts (売上分析、バイタルグラフ等)
- **Drag & Drop**: react-dnd (カンバンボード、予約操作)
- **Animations**: Framer Motion / CSS Transitions

### フォーム & データハンドリング
- **Form Management**: React Hook Form
- **Validation**: Zod (想定)
- **Date Utility**: date-fns

## 3. アーキテクチャ
「bulletproof-react」の設計思想に基づいた **Feature-based Architecture** を採用しています。機能（Feature）ごとにディレクトリを分割し、関心の分離とスケーラビリティを確保しています。

### ディレクトリ構造
```
/
├── components/           # 共有コンポーネント
│   ├── ui/               # shadcn/ui (汎用UIパーツ)
│   ├── shared/           # アプリケーション固有の共有パーツ (Layout, DataTable等)
│   └── figma/            # Figmaインポート用アセットコンポーネント
├── features/             # 機能別モジュール (ドメインロジックの中核)
│   ├── [feature_name]/
│   │   ├── api/          # API通信・データ取得ロジック
│   │   ├── components/   # 機能固有のUIコンポーネント
│   │   ├── hooks/        # ビジネスロジック・状態管理フック
│   │   ├── routes/       # ページコンポーネント (ルーティング先)
│   │   └── types.ts      # 型定義
│   └── ...
├── lib/                  # ユーティリティ、定数、設定
├── styles/               # グローバルスタイル (Tailwind CSS)
└── App.tsx               # アプリケーションエントリポイント
```

### データ永続化の現状
現在、バックエンドAPIは実装されておらず、**Mock Data**（各 feature ディレクトリ内の `mockData.ts`）を使用して動作しています。
データはメモリ上、または一部のステート管理で保持されますが、ブラウザのリロードでリセットされる場合があります。

## 4. 機能一覧

### 4.1 ダッシュボード (`/features/dashboard`)
- **概要**: 病院全体の稼働状況を俯瞰するホーム画面。カンバンボード形式で患者の来院フローを管理します。
- **ワークフロー（カラム構成）**:
    1. **受付予約**: 本日来院予定の予約
    2. **受付済**: 来院済み・待合室待機中
    3. **診療中**: 診察室・処置室で対応中
    4. **会計待ち**: 診察終了・会計計算待ち
    5. **会計済**: 会計完了・帰宅

### 4.2 予約管理 (`/features/reservations`)
- **概要**: 診療・トリミング・手術の予約を一元管理。
- **予約タイプ**:
    - 診療、検診、検査、手術、トリミング、ワクチン、入院、ホテル
- **機能**:
    - カレンダー表示（月表示 / 週表示 / 日表示）
    - 予約の新規作成・編集・キャンセル
    - 患者（ペット）検索と予約紐付け
    - 担当獣医師・診察室の割り当て

### 4.3 電子カルテ (`/features/medical-records`)
- **概要**: SOAPS形式（Subjective, Objective, Assessment, Plan, Surgery/Special）に基づく診療記録。
- **ステータス**: 作成中 → 確定済
- **機能**:
    - **問診 (Interview)**: 主訴、経過、既往歴の記録
    - **身体検査 (Physical Exam)**: 体重、体温、心拍数等のバイタル入力
    - **診断・処置**: 診断登録、処置オーダー
    - **処方**: 薬剤選択、用量指定
    - **画像管理**: 検査画像のアップロード・管理
    - **見積**: 診療内容に基づく概算見積作成

### 4.4 入院管理 (`/features/hospitalization`)
- **概要**: 入院患者のケアプラン作成と日々の記録管理。
- **ステータス**: 入院中、退院済、予約
- **タイプ**: 入院、ホテル
- **機能**:
    - **入院ボード**: 入院患者一覧と現在の状態確認
    - **ケアプラン**: 投薬・処置スケジュールの作成（食事、投薬、処置、指示、アイテム）
    - **デイリーログ**: タスク完了チェック、バイタル・排泄・食事の記録
    - **タイムライン**: 実施記録の時系列表示
    - **コスト管理**: 入院費用の自動計算

### 4.5 会計 (`/features/accounting`)
- **概要**: 診療費の計算と請求書発行。
- **ステータス**: 未収、回収済、キャンセル
- **機能**:
    - 患者選択から会計情報への連携
    - 診療明細の作成・編集
    - 請求書・領収書プレビュー
    - 入金手段管理（現金、クレジットカード、電子マネー）

### 4.6 検査管理 (`/features/examinations`)
- **概要**: 院内・院外検査のオーダーと結果管理。
- **ステータス**: 依頼中、検査中、完了
- **機能**:
    - 検査フォームによるオーダー作成
    - 結果入力とサマリー記録

### 4.7 顧客・ペット管理 (`/features/owners`, `/features/pets`)
- **概要**: 顧客とペットの基本情報管理。
- **機能**:
    - 飼い主情報のCRUD
    - ペット情報のCRUD（画像設定含む）
    - ステータス管理（生存/死亡）

### 4.8 トリミング (`/features/trimming`)
- **概要**: トリミング業務の管理。
- **ステータス**: 予約、進行中、完了
- **機能**:
    - トリミング予約リスト
    - コース選択とオプション管理

### 4.9 ワクチン管理 (`/features/vaccinations`)
- **概要**: 予防接種の管理。
- **機能**:
    - ワクチン接種記録リスト
    - 次回接種予定の管理

### 4.10 設定・マスタ管理 (`/features/master`, `/features/clinic`)
- **概要**: システム全体設定。
- **機能**:
    - クリニック情報設定
    - 診療項目マスタ管理（カテゴリー、単価、在庫連携ID）
    - システム設定

## 5. UI/UX ガイドライン
`/DESIGN_SYSTEM.md` に定義された Notion Like なデザインシステムに準拠します。
- **配色**: オフホワイト（`#F7F6F3`）をベースとした目に優しい配色
- **タイポグラフィ**: 視認性の高いフォントサイズとカラー（`#37352F`）
- **コンポーネント**: shadcn/ui をベースにカスタマイズされた一貫性のあるUIパーツ

## 6. 今後のロードマップ
1. **バックエンド連携**: Supabase等のBaaSを用いたデータ永続化の実装
2. **在庫管理 (Inventory)**:
    - 現状 `types/index.ts` に型定義のみ存在
    - 医薬品・フードの在庫数管理とマスタ連動
3. **シフト管理**: スタッフの勤務シフト作成機能
4. **認証機能**: ログイン/ログアウト、ロールベースアクセス制御 (RBAC)
5. **印刷機能**: 帳票（明細書、処方箋、証明書）の正式な印刷対応
6. **処方機能**: カルテ画面での薬剤選択・用量指定の実装（UIは存在するが機能未実装）
7. **画像管理**: 検査画像のアップロード・表示・管理機能の実装
